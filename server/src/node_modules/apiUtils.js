//prepares the search terms for querying the DB for the current resource
const prepareOptions = (query, alias) => {
	const options = Object.keys(query).map(element => {
		const decodedQueryElement = JSON.parse(query[element] || "[]");

		if (!Array.isArray(decodedQueryElement))
			return "`" + alias[element] + "` LIKE '" + decodedQueryElement + "'"

		const orValues = decodedQueryElement
			.map(orElement =>
				`\`${alias[element]}\` LIKE '${orElement}'`
		);
		
		if(orValues.length)
			return `(${orValues.join(" OR ")})`;
		else
			return `\`${alias[element]}\` LIKE '0'`;
	}, "").join(" AND ");
	return options?` WHERE ${options}`: "";
}
	
export { prepareOptions };