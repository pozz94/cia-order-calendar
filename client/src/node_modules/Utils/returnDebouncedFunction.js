import debounce from "Utils/debounceEvent";

class Debounced {
	constructor(func, time = 250) {
		this.func = func;
		this.time = time;
		this.eventID =
			func.name +
			[...Array(16)]
				.map(i => (~~(Math.random() * 36)).toString(36))
				.join("");
		this.event = new Event(this.eventID);
		this.args = {};
		document.addEventListener(
			this.eventID,
			debounce(() => func(this.args), this.time)
		);
	}

	execute = args => {
		this.args = args;
		document.dispatchEvent(this.event);
	};
}

const deb = (func, time) => {
	return new Debounced(func, time).execute;
};

export default deb;
